# –°–∏—Å—Ç–µ–º–∞ –ø–æ–¥—Å—á–µ—Ç–∞ –Ω–∞—Ä—É—à–µ–Ω–∏–π

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–¥—Å—á–µ—Ç–∞ –Ω–∞—Ä—É—à–µ–Ω–∏–π –¥–ª—è –æ—Ç—á–µ—Ç–æ–≤ –ø–æ —Ä–∞–±–æ—á–µ–º—É –≤—Ä–µ–º–µ–Ω–∏. –°–∏—Å—Ç–µ–º–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç:

- ‚úÖ –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ç–∏–ø—ã –Ω–∞—Ä—É—à–µ–Ω–∏–π
- ‚úÖ –ö–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∏—Ö –ø–æ —Å—Ç–µ–ø–µ–Ω–∏ —Å–µ—Ä—å–µ–∑–Ω–æ—Å—Ç–∏  
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥—Å—á–∏—Ç—ã–≤–∞—Ç—å –Ω–∞—Ä—É—à–µ–Ω–∏—è –≤ –æ—Ç—á–µ—Ç–∞—Ö
- ‚úÖ –ü–æ–ª—É—á–∞—Ç—å –¥–µ—Ç–∞–ª—å–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –Ω–∞—Ä—É—à–µ–Ω–∏—è–º

## üóÉÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü–∞ `violations`

```sql
CREATE TABLE violations (
  id TEXT PRIMARY KEY,
  userId TEXT NOT NULL,
  siteId TEXT,
  type TEXT NOT NULL,
  description TEXT NOT NULL,
  timestamp TEXT NOT NULL,
  severity TEXT NOT NULL DEFAULT 'medium',
  isResolved INTEGER NOT NULL DEFAULT 0,
  createdAt TEXT NOT NULL DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (userId) REFERENCES users (id),
  FOREIGN KEY (siteId) REFERENCES construction_sites (id)
);
```

## üìä –¢–∏–ø—ã –Ω–∞—Ä—É—à–µ–Ω–∏–π

| –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ | –û–±—ã—á–Ω–∞—è —Å–µ—Ä—å–µ–∑–Ω–æ—Å—Ç—å |
|-----|----------|-------------------|
| `unauthorized_departure` | –ü–æ–∫–∏–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ –±–µ–∑ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è | high |
| `late_arrival` | –û–ø–æ–∑–¥–∞–Ω–∏–µ –Ω–∞ —Ä–∞–±–æ—Ç—É | medium |
| `early_departure` | –†–∞–Ω–Ω–∏–π —É—Ö–æ–¥ —Å —Ä–∞–±–æ—Ç—ã | medium |
| `no_show` | –ù–µ—è–≤–∫–∞ –Ω–∞ —Ä–∞–±–æ—Ç—É | high |

## üö® –£—Ä–æ–≤–Ω–∏ —Å–µ—Ä—å–µ–∑–Ω–æ—Å—Ç–∏

- **`low`** - –ù–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Ä—É—à–µ–Ω–∏—è
- **`medium`** - –°—Ä–µ–¥–Ω–∏–µ –Ω–∞—Ä—É—à–µ–Ω–∏—è
- **`high`** - –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –Ω–∞—Ä—É—à–µ–Ω–∏—è

## üîß –ù–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã –≤ DatabaseService

### `createViolation(violation)`
–°–æ–∑–¥–∞–µ—Ç –Ω–æ–≤–æ–µ –Ω–∞—Ä—É—à–µ–Ω–∏–µ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.

```typescript
await db.createViolation({
  userId: 'user123',
  siteId: 'site456',
  type: 'late_arrival',
  description: '–û–ø–æ–∑–¥–∞–Ω–∏–µ –Ω–∞ 15 –º–∏–Ω—É—Ç',
  severity: 'medium'
});
```

### `getViolations(period, severity)`
–ü–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –Ω–∞—Ä—É—à–µ–Ω–∏–π –∑–∞ –ø–µ—Ä–∏–æ–¥ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –ø–æ —Å–µ—Ä—å–µ–∑–Ω–æ—Å—Ç–∏.

```typescript
const violations = await db.getViolations('month', 'high');
```

### `getViolationsSummary(period)`
–ü–æ–ª—É—á–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –Ω–∞—Ä—É—à–µ–Ω–∏—è–º –∑–∞ –ø–µ—Ä–∏–æ–¥.

```typescript
const summary = await db.getViolationsSummary('week');
// –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
// {
//   total: 5,
//   resolved: 2,
//   unresolved: 3,
//   byType: { late_arrival: 3, unauthorized_departure: 2 },
//   bySeverity: { low: 1, medium: 2, high: 2 }
// }
```

### `resolveViolation(violationId)`
–ü–æ–º–µ—á–∞–µ—Ç –Ω–∞—Ä—É—à–µ–Ω–∏–µ –∫–∞–∫ —Ä–µ—à–µ–Ω–Ω–æ–µ.

```typescript
await db.resolveViolation('viol123');
```

### `deleteViolation(violationId)`
–£–¥–∞–ª—è–µ—Ç –Ω–∞—Ä—É—à–µ–Ω–∏–µ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.

```typescript
await db.deleteViolation('viol123');
```

## üìà –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –æ—Ç—á–µ—Ç–∞–º–∏

–ú–µ—Ç–æ–¥ `getWorkReports()` —Ç–µ–ø–µ—Ä—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞—Ä—É—à–µ–Ω–∏–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–∞–±–æ—Ç–Ω–∏–∫–∞:

```typescript
const reports = await db.getWorkReports('month');
// –ö–∞–∂–¥—ã–π –æ—Ç—á–µ—Ç —Ç–µ–ø–µ—Ä—å –≤–∫–ª—é—á–∞–µ—Ç –ø–æ–ª–µ violations:
// {
//   userId: 'user123',
//   userName: '–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤',
//   siteId: 'site456',
//   siteName: '–°—Ç—Ä–æ–π–∫–∞ ‚Ññ1',
//   totalHours: 160,
//   totalMinutes: 0,
//   shiftsCount: 20,
//   date: '2024-01-15',
//   violations: 3  // <- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–¥—Å—á–µ—Ç
// }
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã —Å–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `test_violations.js`:

```bash
node test_violations.js
```

–¢–µ—Å—Ç —Å–æ–∑–¥–∞–µ—Ç —Ç–µ—Å—Ç–æ–≤—ã–µ –Ω–∞—Ä—É—à–µ–Ω–∏—è –∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–∞–±–æ—Ç—É –≤—Å–µ—Ö –º–µ—Ç–æ–¥–æ–≤.

## üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–∞—Ä—É—à–µ–Ω–∏–π

–í –±—É–¥—É—â–µ–º –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–∞—Ä—É—à–µ–Ω–∏–π –Ω–∞ –æ—Å–Ω–æ–≤–µ:

- GPS-—Ç—Ä–µ–∫–∏–Ω–≥–∞ (–ø–æ–∫–∏–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ –±–µ–∑ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è)
- –†–∞–±–æ—á–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ (–æ–ø–æ–∑–¥–∞–Ω–∏—è, —Ä–∞–Ω–Ω–∏–µ —É—Ö–æ–¥—ã)
- –°–∏—Å—Ç–µ–º—ã —É—á–µ—Ç–∞ —Ä–∞–±–æ—á–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ (–Ω–µ—è–≤–∫–∏)

## üì± –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ

### –í –æ—Ç—á–µ—Ç–∞—Ö –ø–æ —Ä–∞–±–æ—Ç–µ
```typescript
// WorkReportsScreen.tsx
const reports = await DatabaseService.getInstance().getWorkReports(period);
// reports[i].violations —Ç–µ–ø–µ—Ä—å —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞—Ä—É—à–µ–Ω–∏–π
```

### –í –æ—Ç—á–µ—Ç–∞—Ö –ø–æ –Ω–∞—Ä—É—à–µ–Ω–∏—è–º
```typescript
// ViolationsReportScreen.tsx
const violations = await DatabaseService.getInstance().getViolations(period, severity);
const summary = await DatabaseService.getInstance().getViolationsSummary(period);
```

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç

- [x] TODO: Implement violations count - **–ó–ê–í–ï–†–®–ï–ù–û**
- [x] –°–æ–∑–¥–∞–Ω–∞ —Ç–∞–±–ª–∏—Ü–∞ violations –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- [x] –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–¥—Å—á–µ—Ç –Ω–∞—Ä—É—à–µ–Ω–∏–π –≤ –æ—Ç—á–µ—Ç–∞—Ö
- [x] –î–æ–±–∞–≤–ª–µ–Ω—ã –º–µ—Ç–æ–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –Ω–∞—Ä—É—à–µ–Ω–∏—è–º–∏
- [x] –°–æ–∑–¥–∞–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –Ω–∞—Ä—É—à–µ–Ω–∏—è–º
- [x] –î–æ–±–∞–≤–ª–µ–Ω—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ TypeScript —Ç–∏–ø—ã
- [x] –°–æ–∑–¥–∞–Ω —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç

–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é! üéâ 